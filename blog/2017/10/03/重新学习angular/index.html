<!-- -> 定义页面布局--><!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge, chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"><meta name="keywords" content="Mrzjd Mrzebra hexo IT font-end 前端 技术"><meta name="keywords" content="JavaScript,Angular"><link rel="stylesheet" href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.bootcss.com/github-markdown-css/2.8.0/github-markdown.min.css"><link rel="stylesheet" href="/blog/less/main.css"><link rel="icon" href="/blog/images/favicon.png"><title>Angular</title><script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script><script src="/blog/js/article.js"></script></head><body><header class="header"><h1 class="logo"><a href="/blog/" style="background-image:url(/blog//images/zblog-logo.png);">zblog</a></h1><i class="icon-list fa fa-bars"></i></header><div class="list-container"><ul class="header-list"><li class="header-item"><a href="/blog" title="HOME">HOME</a></li><li class="header-item"><a href="/blog/archives" title="Archives">Archives</a></li><li class="header-item"><a href="https://github.com/mrzjd" title="Github">Github</a></li></ul><div class="list-close"><i class="icon-close fa fa-times-circle-o"></i></div></div><div class="content"><article><div class="title-box"><h1 class="title"><span class="arti-tag" style="background:#B52E31;">Angular</span>Angular</h1><div class="date"><i class="icon-calendar fa fa-calendar"></i><span class="time">2017.10.03</span></div></div><div class="article-text markdown-body"><h2 id="前沿"><a href="#前沿" class="headerlink" title="前沿"></a>前沿</h2><p>Angular是有Google主导的一套JS开发平台，他有完整的构建体系，以及采用TypeScript所带来的构建大型应用的流畅开发体验。</p>
<h2 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">npm install -g @angular/cli</span><br><span class="line"></span><br><span class="line">ng new project-name</span><br><span class="line"></span><br><span class="line">cd project-name</span><br><span class="line"></span><br><span class="line">ng serve --open</span><br><span class="line"></span><br><span class="line">npm start</span><br></pre></td></tr></table></figure>
<h2 id="架构概览"><a href="#架构概览" class="headerlink" title="架构概览"></a>架构概览</h2><p><img src="https://angular.cn/generated/images/guide/architecture/overview2.png" alt="架构" style="max-width:80%"></p>
<ol>
<li>使用Angular扩展语法编写HTML模块</li>
<li>使用组件类管理这些模板</li>
<li>使用Services添加服务</li>
<li>利用模块系统打包发布组件与服务</li>
</ol>
<h2 id="模块系统"><a href="#模块系统" class="headerlink" title="模块系统"></a>模块系统</h2><blockquote>
<p>每个应用至少有一个根模块 AppModule</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">//-- app.module.ts</span><br><span class="line"></span><br><span class="line">import &#123;NgModule&#125; from &apos;@angular/core&apos;;</span><br><span class="line">import &#123;BrowserModule&#125; from &apos;@angular/platform-browser&apos;;</span><br><span class="line">import &#123;AppComponent&#125; from &apos;./app.component&apos;;</span><br><span class="line"></span><br><span class="line">@NgModule(&#123;</span><br><span class="line">	declarations: [</span><br><span class="line">		AppComponent</span><br><span class="line">	],</span><br><span class="line">	exports: [],</span><br><span class="line">	imports: [</span><br><span class="line">		BrowserModule</span><br><span class="line">	],</span><br><span class="line">	providers: [],</span><br><span class="line">	bootstrap: [AppComponent]</span><br><span class="line">&#125;)</span><br><span class="line">export class AppModule &#123;&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//-- 引导文件</span><br><span class="line"></span><br><span class="line">import &#123;platformBrowserDynamic&#125; from &apos;@angular/platform-browser-dynamic&apos;;</span><br><span class="line">import &#123;AppModule&#125; from &apos;app/app.module&apos;;</span><br><span class="line"></span><br><span class="line">platformBrowserDynamic().bootstrapModule(AppModule);</span><br></pre></td></tr></table></figure>
<h2 id="模板与数据绑定"><a href="#模板与数据绑定" class="headerlink" title="模板与数据绑定"></a>模板与数据绑定</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">// - template</span><br><span class="line"></span><br><span class="line">// 1. 元素, 指令, 组件 -&gt; 绑定值</span><br><span class="line">&lt;img [src]=&quot;imgurl&quot;/&gt;</span><br><span class="line">&lt;div [ngClass]=&quot;&#123;&apos;special&apos;:isSpecial&#125;&quot;&gt;&lt;/div&gt;</span><br><span class="line">&lt;child [prop]=&quot;parentProp&quot;&gt;&lt;/child&gt;</span><br><span class="line"></span><br><span class="line">// 2. 绑定事件</span><br><span class="line">&lt;button (click)=&quot;onClick($event)&quot;&gt;&lt;/button&gt;</span><br><span class="line">&lt;div (myClick)=&quot;click=$event&quot; clickable&gt;绑定clickable指令的事件别名&lt;/div&gt;</span><br><span class="line">&lt;child (eventType)=&quot;listener()&quot;&gt;&lt;/child&gt;</span><br><span class="line"></span><br><span class="line">// 3. 多种用法</span><br><span class="line">&lt;button [attr.aria-label]=&quot;help&quot;&gt;绑定到属性Attribute上&lt;/button&gt;</span><br><span class="line">&lt;div [class.special]=&quot;isSpecial&quot;&gt;&lt;/div&gt;</span><br><span class="line">&lt;p [style.color]=&quot;isSpecial ? &apos;red&apos; : &apos;green&apos;&quot;&gt;&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">// 4. others</span><br><span class="line">&lt;img src=&quot;&#123;&#123;imgurl&#125;&#125;&quot;/&gt;</span><br><span class="line">&lt;p&gt;&#123;&#123;specialHTML&#125;&#125; - 内容会转义输出&lt;/p&gt;</span><br><span class="line">&lt;p [innerHTML]=&quot;specialHTML&quot;&gt;&lt;/p&gt;</span><br></pre></td></tr></table></figure>
<h3 id="指令系统"><a href="#指令系统" class="headerlink" title="指令系统"></a>指令系统</h3><ol>
<li>NgIf</li>
</ol>
<blockquote>
<p>区别NgIf与隐藏元素的区别：ngIf会销毁组件及状态(用于提升性能), 隐藏只是样式层面的显隐切换(用于提升交互); 此外ngIf可用于防范空指针错误</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;div class=&quot;ngIfBox&quot;&gt;</span><br><span class="line">	&lt;h2&gt;ngIfBox&lt;/h2&gt;</span><br><span class="line">	&lt;button (click)=&quot;toggleShow()&quot;&gt;&#123;&#123;ngIfState ? &apos;hide&apos; : &apos;show&apos;&#125;&#125;&lt;/button&gt;</span><br><span class="line">	&lt;p *ngIf=&quot;ngIfState&quot;&gt;ng if show or hide&lt;/p&gt;</span><br><span class="line">	&lt;p [style.display]=&quot;ngIfState ? &apos;block&apos; : &apos;none&apos;&quot;&gt;class hidden show or hide&lt;/p&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<ol>
<li>NgFor</li>
</ol>
<blockquote>
<p>了解带索引循环，用trackBy提升渲染性能</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">//-- template</span><br><span class="line">&lt;div class=&quot;ngForBox&quot;&gt;</span><br><span class="line">	&lt;ul class=&quot;mylist&quot; (click)=&quot;delegateChild($event)&quot;&gt;</span><br><span class="line">		&lt;li *ngFor=&quot;let val of myList; let i=index; trackBy: traceByIds&quot;&gt;&#123;&#123;val.name&#125;&#125; -- &#123;&#123;val.id&#125;&#125;&lt;/li&gt;</span><br><span class="line">	&lt;/ul&gt;</span><br><span class="line">	&lt;button (click)=&quot;additem()&quot;&gt;add item&lt;/button&gt;</span><br><span class="line">	&lt;button (click)=&quot;deleitem()&quot;&gt;delete item&lt;/button&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">//-- class</span><br><span class="line">myList = [</span><br><span class="line">	&#123;id: 1, name: &apos;qwe&apos;&#125;,</span><br><span class="line">	&#123;id: 2, name: &apos;asd&apos;&#125;,</span><br><span class="line">	&#123;id: 3, name: &apos;zxc&apos;&#125;</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line">additem = function () &#123;</span><br><span class="line">	this.myList.push(&#123;</span><br><span class="line">		id: this.myList.length + 1,</span><br><span class="line">		name: &apos;additem&apos;</span><br><span class="line">	&#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">deleitem = function () &#123;</span><br><span class="line">	this.myList.splice(this.myList.length - 1);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">delegateChild = function (evt) &#123;</span><br><span class="line">	console.log(evt.target);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">traceByIds = function (index: number, val): number &#123;</span><br><span class="line">	return val.id;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<ol>
<li>NgSwitch</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;div class=&quot;ngSwitchBox&quot; [ngSwitch]=&quot;myCase&quot;&gt;</span><br><span class="line">	&lt;div class=&quot;case-a&quot; *ngSwitchCase=&quot;&apos;caseA&apos;&quot;&gt;Case-A&lt;/div&gt;</span><br><span class="line">	&lt;div class=&quot;case-b&quot; *ngSwitchCase=&quot;&apos;caseB&apos;&quot;&gt;Case-B&lt;/div&gt;</span><br><span class="line">	&lt;div class=&quot;case-c&quot; *ngSwitchCase=&quot;&apos;caseC&apos;&quot;&gt;Case-C&lt;/div&gt;</span><br><span class="line">	&lt;div class=&quot;case-default&quot; *ngSwitchDefault&gt;Case-Default&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<ol>
<li>模板引用变量</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;div class=&quot;refValBox&quot;&gt;</span><br><span class="line">	 &lt;input #refVal placeholder=&quot;tplVarity Number&quot;/&gt;</span><br><span class="line">	 &lt;button (click)=&quot;log(refVal.value)&quot;&gt;click me!&lt;/button&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<ol>
<li>模板表达式操作符</li>
</ol>
<blockquote>
<p>管道操作符(|), 安全导航操作符(?)</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;div class=&quot;optsBox&quot;&gt;</span><br><span class="line">	&lt;p&gt;&#123;&#123;hero.name&#125;&#125;&lt;/p&gt;</span><br><span class="line">	&lt;p&gt;&#123;&#123;hero.child?.name&#125;&#125;&lt;/p&gt;</span><br><span class="line">	&lt;p&gt;&#123;&#123;hero.parent!.name&#125;&#125;&lt;/p&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">// class</span><br><span class="line">hero = &#123;</span><br><span class="line">	name : &apos;zjd123&apos;,</span><br><span class="line">	age : 23,</span><br><span class="line">	parent : &#123;</span><br><span class="line">		name : &apos;qwe123&apos;</span><br><span class="line">	&#125;,</span><br><span class="line">	child : null</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="组件"><a href="#组件" class="headerlink" title="组件"></a>组件</h2><ol>
<li>组件生命周期</li>
</ol>
<blockquote>
<p>ngOnChanges -&gt; ngOnInit -&gt; ngDoCheck -&gt; ngAfterContentChecked/ngAfterContentInit -&gt; ngAfterViewInit/ngAfterViewChecked -&gt; ngOnDestory</p>
</blockquote>
<ol>
<li>组件之间的交互</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">// 1. 父组件传递数据到子组件</span><br><span class="line">// parnet tpl</span><br><span class="line">&lt;child [info]=&quot;childInfo&quot;&gt;&lt;/child&gt;</span><br><span class="line"></span><br><span class="line">// child tpl</span><br><span class="line">&lt;div&gt;&lt;label&gt;Name: &lt;/label&gt;&#123;&#123;childInfo.name&#125;&#125;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">// child class</span><br><span class="line">// a. 通过setter进行变化拦截</span><br><span class="line">// b. 通过onChanges进行变化拦截</span><br><span class="line">childInfo: Info;</span><br><span class="line"></span><br><span class="line">@Input()</span><br><span class="line">set info (info: Info) &#123;</span><br><span class="line">	this.childInfo = info;</span><br><span class="line">	console.log(&apos;Setter for Info&apos;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ngOnChanges (changes: &#123;</span><br><span class="line">	[propKey: string]: SimpleChange</span><br><span class="line">&#125;) &#123;</span><br><span class="line">	console.log(changes);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">// 2. 父组件监听子组件的事件</span><br><span class="line">// parent tpl</span><br><span class="line">&lt;child (evtType)=&quot;evtHandler($event)&quot;&gt;&lt;/child&gt;</span><br><span class="line"></span><br><span class="line">// child class</span><br><span class="line">@Output()</span><br><span class="line">evtType = new EventEmitter&lt;T&gt;();</span><br><span class="line"></span><br><span class="line">this.evtType.emit(T);</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// 3. 通过模板引用变量互动</span><br><span class="line">&lt;countdown-timer #timer&gt;&lt;/counter-timer&gt;</span><br><span class="line">&lt;button (click)=&quot;timer.start()&quot;&gt;Start!&lt;/button&gt;</span><br><span class="line">&lt;button (click)=&quot;timer.stop()&quot;&gt;Stop!&lt;/button&gt;</span><br><span class="line">&lt;div class=&quot;seconds&quot;&gt;&#123;&#123; timer.seconds &#125;&#125;&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// 4. 父组件调用@ViewChild</span><br><span class="line"></span><br><span class="line">@ViewChild(ChildBoxComponent)</span><br><span class="line">private childComponent = ChildBoxComponent;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">// 5. 通过service通讯</span><br></pre></td></tr></table></figure>
<h2 id="动态加载组件"><a href="#动态加载组件" class="headerlink" title="动态加载组件"></a>动态加载组件</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">// template</span><br><span class="line">&lt;ng-template appAdHost&gt;&lt;/ng-template&gt;</span><br><span class="line"></span><br><span class="line">// class</span><br><span class="line">@ViewChild(AdDirective)</span><br><span class="line">adHost: AdDirective;</span><br><span class="line"></span><br><span class="line">constructor (private componentFactoryResolver: ComponentFactoryResolver) &#123;&#125;</span><br><span class="line"></span><br><span class="line">ngAfterViewInit () &#123;</span><br><span class="line">	this.loadComponent();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ngOnDestroy () &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">loadComponent () &#123;</span><br><span class="line">	let compFactory = this.componentFactoryResolver.resolveComponentFactory(SampleComponent);</span><br><span class="line"></span><br><span class="line">	let viewContainerRef = this.adHost.viewContainerRef;</span><br><span class="line"></span><br><span class="line">	viewContainerRef.clear();</span><br><span class="line"></span><br><span class="line">	let componentRef = viewContainerRef.createComponent(compFactory);</span><br><span class="line"></span><br><span class="line">	(&lt;AdComponent&gt;componentRef.instance).data = this.data;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//-- SampleComponent为需要动态载入的组件</span><br><span class="line">//-- AdDirective为指令类型</span><br><span class="line"></span><br><span class="line">//-- module.ts中声明所有文件，entryComponents中声明动态载入的组件</span><br></pre></td></tr></table></figure>
<h2 id="指令系统-1"><a href="#指令系统-1" class="headerlink" title="指令系统"></a>指令系统</h2><ol>
<li>自定义属性型指令</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">import &#123; Directive, ElementRef, Input &#125; from &apos;@angular/core&apos;;</span><br><span class="line"></span><br><span class="line">import &#123; HostListener &#125; from &apos;@angular/core&apos;;</span><br><span class="line"></span><br><span class="line">@Directive(&#123;</span><br><span class="line">	selector: &apos;[appHighlight]&apos; // 指令名</span><br><span class="line">&#125;)</span><br><span class="line">export class  HightlightDirective &#123;</span><br><span class="line">	// 获取对应的元素</span><br><span class="line">	constructor (el: ElementRef) &#123;</span><br><span class="line">		el.nativeElement.style.backgroundColor = &apos;yellow&apos;;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	// 捕获元素上的事件</span><br><span class="line">	@HostListener(&apos;mouseenter&apos;)</span><br><span class="line">	onMouseEnter () &#123;</span><br><span class="line">		console.log(&apos;Mouse Enter!&apos;);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	@HostListener(&apos;mouseleave&apos;)</span><br><span class="line">	onMouseLeave () &#123;</span><br><span class="line">		console.log(&apos;Mouse Leave!&apos;);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 可以通过Input获取属性参数值</span><br></pre></td></tr></table></figure>
<ol>
<li>自定义结构型指令</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">// 原理与动态加载组件相同。</span><br><span class="line">// 这里重复练习一遍，深入理解运作原理。</span><br><span class="line"></span><br><span class="line">import &#123; Directive, ViewContainerRef, TemplateRef, Input &#125; from &apos;@angular/core&apos;;</span><br><span class="line"></span><br><span class="line">@Directive(&#123;</span><br><span class="line">	selector: &apos;[appList]&apos;</span><br><span class="line">&#125;)</span><br><span class="line">export class ApplistDirective &#123;</span><br><span class="line">	constructor (</span><br><span class="line">		private templateRef: TemplateRef&lt;any&gt;,</span><br><span class="line">		private viewContainer: ViewContainerRef) &#123;&#125;</span><br><span class="line"></span><br><span class="line">	@Input()</span><br><span class="line">	set appList(list) &#123;</span><br><span class="line">		if (list) &#123;</span><br><span class="line">			console.log(list);</span><br><span class="line">			this.viewContainer.createEmbeddedView(this.templateRef);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol>
<li>自定义管道</li>
</ol>
<blockquote>
<p>理解纯管道与非纯管道的区别：是否影响引用的内部变化从而引起检查。非纯管道代表：AsyncPipe;</p>
<p>每个绑定的管道都有自己的实例(区别于服务数据不共用)</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">import &#123; Pipe, PipeTransform &#125; from &apos;@angular/core&apos;;</span><br><span class="line"></span><br><span class="line">@Pipe(&#123;</span><br><span class="line">	name: &apos;expStrength&apos;</span><br><span class="line">&#125;)</span><br><span class="line">export class ExpStrengthPipe implements PipeTransform &#123;</span><br><span class="line">	transform (target: number, param: number) &#123;</span><br><span class="line">		return target * param;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="动画"><a href="#动画" class="headerlink" title="动画"></a>动画</h2><blockquote>
<p>*状态表示匹配任何动画状态<br>void状态表示元素没有添加试图的时候</p>
<p>void =&gt; &lowast; (别名 = :enter): 进场动画<br>&lowast; =&gt; void (别名 = :leave): 离场动画</p>
<p>动画回调：<code>(@animationName.start)=”start($event)” (@animationName.done)=”done($event)”</code></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">//-- app.module</span><br><span class="line">import &#123; BrowserAnimationsModule &#125; from &apos;@angular/platform-browser/animations&apos;;</span><br><span class="line"></span><br><span class="line">//-- component</span><br><span class="line">import &#123; trigger, state, style, animate, transition &#125; from &apos;@angular/animations&apos;;</span><br><span class="line"></span><br><span class="line">template: `</span><br><span class="line">	&lt;div [@heroState]=&quot;mystate&quot;&gt;hello animations!&lt;/div&gt;</span><br><span class="line">`,</span><br><span class="line">animations: [</span><br><span class="line">	trigger(&apos;heroState&apos;, [</span><br><span class="line">		state(&apos;inactive&apos;, style(&#123;backgroundColor: &apos;#eee&apos;&#125;)),</span><br><span class="line">		state(&apos;active&apos;, style(&#123;backgroundColor: &apos;#111&apos;&#125;)),</span><br><span class="line">		transition(&apos;inactive =&gt; active&apos;, animate(&apos;1000ms ease-in&apos;)),</span><br><span class="line">		transition(&apos;active =&gt; inactive&apos;, animate(&apos;1000ms ease-out&apos;))</span><br><span class="line">	])</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<h2 id="DI依赖注入"><a href="#DI依赖注入" class="headerlink" title="DI依赖注入"></a>DI依赖注入</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">import &#123; Injectable &#125; from &apos;@angular/core&apos;;</span><br><span class="line"></span><br><span class="line">@Injectable()</span><br><span class="line">export class DependencyService &#123;</span><br><span class="line">	info = &#123;</span><br><span class="line">		type: &apos;testType&apos;,</span><br><span class="line">		name: &apos;diService&apos;,</span><br><span class="line">		count: 0</span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line">	constructor () &#123;&#125;</span><br><span class="line"></span><br><span class="line">	getInfo () &#123;</span><br><span class="line">		this.info.count++;</span><br><span class="line">		return this.info;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// inject</span><br><span class="line">providers: [ DependencyService ]</span><br><span class="line">constructor (private diService: DependencyService) &#123;&#125;</span><br></pre></td></tr></table></figure>
<h2 id="HttpClient"><a href="#HttpClient" class="headerlink" title="HttpClient"></a>HttpClient</h2><blockquote>
<p>可以通过结果来描述返回值类型</p>
<p>请求非json数据 <code>http.get(‘/textfile.txt’, {responseType: ‘text’})</code></p>
<p>可以利用Rxjs 操作符进行复杂处理</p>
<p>post api等详情见接口文档 <a href="https://angular.cn/guide/http" target="_blank" rel="noopener">Angular Http</a></p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">import &#123; HttpClient &#125; from &apos;@angular/common/http&apos;;</span><br><span class="line"></span><br><span class="line">constructor (private http: HttpClient) &#123;&#125;</span><br><span class="line"></span><br><span class="line">ngOnInit () &#123;</span><br><span class="line">	this.http.get(&apos;https://api.github.com/search/repositories?q=angular&apos;)</span><br><span class="line">		.subscribe(data =&gt; &#123;</span><br><span class="line">			this.res = data;</span><br><span class="line">		&#125;, err =&gt; &#123;</span><br><span class="line">			console.error(err);</span><br><span class="line">		&#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="路由"><a href="#路由" class="headerlink" title="路由"></a>路由</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">//-- index.html</span><br><span class="line">&lt;base href=&quot;/&quot;&gt;</span><br><span class="line"></span><br><span class="line">//-- module</span><br><span class="line">import &#123; routerModule &#125; from &apos;././.&apos;;</span><br><span class="line"></span><br><span class="line">//-- component template 路由出口</span><br><span class="line">&lt;router-outlet&gt;&lt;/router-outlet&gt;</span><br><span class="line"></span><br><span class="line">//-- template 导航</span><br><span class="line">&lt;a routerLink=&quot;/crisis-center&quot; routerLinkActive=&quot;active&quot;&gt;Crisis Center&lt;/a&gt;</span><br><span class="line"></span><br><span class="line">//-- routerModule</span><br><span class="line">import &#123; RouterModule, Routes &#125; from &apos;@angular/router&apos;;</span><br><span class="line"></span><br><span class="line">const appRoutes: Routes = [</span><br><span class="line">  &#123; path: &apos;crisis-center&apos;, component: CrisisListComponent &#125;,</span><br><span class="line">  &#123; path: &apos;hero/:id&apos;,      component: HeroDetailComponent &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: &apos;heroes&apos;,</span><br><span class="line">    component: HeroListComponent,</span><br><span class="line">    data: &#123; title: &apos;Heroes List&apos; &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123; path: &apos;&apos;,</span><br><span class="line">    redirectTo: &apos;/heroes&apos;,</span><br><span class="line">    pathMatch: &apos;full&apos;</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123; path: &apos;**&apos;, component: PageNotFoundComponent &#125;</span><br><span class="line">];</span><br><span class="line">RouterModule.forRoot(</span><br><span class="line">	appRoutes,</span><br><span class="line">	&#123; enableTracing: true &#125; // &lt;-- debugging purposes only</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">//-- components - ActivatedRoute对象 获取当前路由信息</span><br><span class="line">import &#123; ActivatedRoute, ParamMap &#125; from &apos;@angular/router&apos;;</span><br><span class="line">import &apos;rxjs/add/operator/switchMap&apos;;</span><br><span class="line">import &#123; Observable &#125; from &apos;rxjs/Observable&apos;;</span><br><span class="line"></span><br><span class="line">constructor(</span><br><span class="line">	private service: HeroService,</span><br><span class="line">	private route: ActivatedRoute</span><br><span class="line">) &#123;&#125;</span><br><span class="line"></span><br><span class="line">ngOnInit() &#123;</span><br><span class="line">	this.heroes$ = this.route.paramMap</span><br><span class="line">	  .switchMap((params: ParamMap) =&gt; &#123;</span><br><span class="line">		// (+) before `params.get()` turns the string into a number</span><br><span class="line">		this.selectedId = +params.get(&apos;id&apos;);</span><br><span class="line">		return this.service.getHeroes();</span><br><span class="line">	  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h2><ul>
<li>本贴只包括angular4的基础知识内容，更多内容在实战接触后在总结</li>
<li><a href="https://angular.cn/guide/" target="_blank" rel="noopener">Angular中文网</a></li>
</ul>
</div></article></div><footer class="footer"><p class="info">Welcome to mrzjd's blog!</p><div class="infobox"><ul class="contacts"><li class="contacts-i">QQ: 390303304</li><li class="contacts-i">Mail: 390303304@qq.com</li></ul><p>Powered by hexo and github. The theme is zebra-theme.</p></div></footer></body></html>